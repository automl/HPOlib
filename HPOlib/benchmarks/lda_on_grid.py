import sys


def save_lda_on_grid(params, ret_time=False, **kwargs):
    if "Kappa" not in params or "Tau" not in params or "S" not in params:
        sys.stderr.write("No params found ['Kappa', 'Tau', 'S']: %s\n" %
                         str(params))
        return float("NaN")

    kappa = params["Kappa"]
    tau = params["Tau"]
    s = params["Tau"]

    if hasattr(kappa, "__len__"):
        kappa = kappa[0]
        tau = tau[0]
        s = s[0]

    kappa = int(float(kappa))
    tau = int(float(tau))
    s = int(float(s))

    return lda_on_grid(kappa, tau, s, ret_time=ret_time)


def lda_on_grid(kappa, tau, s, ret_time=False):
    # Values for an 6*8*8 grid search which was performed by Hofman et. al.
    # Values obtained from Jasper Snoek
    # Kappa Tau S Value Time
    # ret_time: return time instead of perplexity
    import numpy as np

    configurations = np.array([
        [1.000000, 4.000000, 16.000000, 2014.255351, 36393.190000],
        [0.900000, 1024.000000, 4096.000000, 1680.540179, 36419.510000],
        [0.600000, 1024.000000, 4096.000000, 1328.191297, 24219.850000],
        [0.600000, 16.000000, 4.000000, 2859.440420, 18862.010000],
        [0.700000, 1.000000, 4096.000000, 1313.263743, 11218.420000],
        [0.500000, 64.000000, 16384.000000, 1271.869567, 18228.940000],
        [0.600000, 64.000000, 4.000000, 2630.424468, 18970.510000],
        [1.000000, 1.000000, 1.000000, 2547.784743, 36317.510000],
        [1.000000, 16.000000, 64.000000, 1558.076377, 29985.160000],
        [0.500000, 256.000000, 16384.000000, 1278.123799, 20822.350000],
        [0.800000, 256.000000, 4096.000000, 1361.320422, 30758.540000],
        [0.600000, 256.000000, 16.000000, 1800.429160, 10775.890000],
        [0.500000, 4.000000, 64.000000, 2084.897678, 14864.830000],
        [0.800000, 64.000000, 256.000000, 1349.812010, 17315.100000],
        [1.000000, 16.000000, 4.000000, 2079.802409, 36338.350000],
        [0.500000, 1.000000, 4.000000, 3624.167804, 12595.790000],
        [0.900000, 16.000000, 16.000000, 1749.505296, 27772.590000],
        [0.800000, 1.000000, 4096.000000, 1310.060860, 15432.120000],
        [1.000000, 64.000000, 1024.000000, 1343.801912, 19662.620000],
        [0.700000, 1.000000, 64.000000, 1983.587762, 10802.270000],
        [0.500000, 4.000000, 16.000000, 2804.748620, 12678.520000],
        [0.700000, 256.000000, 64.000000, 1427.856381, 10884.970000],
        [0.900000, 16.000000, 1024.000000, 1317.263697, 15282.860000],
        [0.500000, 256.000000, 1.000000, 5000.332116, 12602.320000],
        [1.000000, 1024.000000, 4.000000, 1637.661866, 36225.830000],
        [0.800000, 1024.000000, 4096.000000, 1537.873629, 36424.780000],
        [0.900000, 16.000000, 4.000000, 2040.531678, 36327.940000],
        [0.500000, 64.000000, 1.000000, 5022.511473, 14693.930000],
        [1.000000, 4.000000, 256.000000, 1472.690781, 25890.240000],
        [1.000000, 64.000000, 16.000000, 1572.944521, 36307.320000],
        [0.800000, 1024.000000, 4.000000, 1528.555961, 19240.020000],
        [0.800000, 64.000000, 16.000000, 1631.072354, 15148.720000],
        [0.900000, 64.000000, 16.000000, 1541.968527, 25795.950000],
        [0.900000, 1024.000000, 256.000000, 1468.342464, 25968.680000],
        [0.700000, 4.000000, 1.000000, 2968.382913, 27098.820000],
        [0.900000, 1.000000, 64.000000, 1886.883404, 23495.740000],
        [0.800000, 4.000000, 16.000000, 2101.979941, 14956.600000],
        [0.600000, 1.000000, 16.000000, 2601.345619, 10651.960000],
        [0.900000, 1024.000000, 64.000000, 1506.415675, 21523.900000],
        [0.700000, 16.000000, 16384.000000, 1271.574590, 24894.000000],
        [1.000000, 1.000000, 4.000000, 2524.250165, 36327.700000],
        [1.000000, 1024.000000, 16384.000000, 2250.711024, 36354.110000],
        [0.800000, 4.000000, 1.000000, 2566.382537, 29395.750000],
        [0.600000, 64.000000, 64.000000, 1630.248431, 8734.110000],
        [0.800000, 16.000000, 16.000000, 1836.733098, 17066.550000],
        [0.500000, 16.000000, 16384.000000, 1266.167382, 16119.520000],
        [0.500000, 1024.000000, 256.000000, 1364.836274, 10978.410000],
        [0.600000, 1.000000, 1024.000000, 1435.221761, 8879.080000],
        [0.600000, 4.000000, 4.000000, 3053.489799, 18842.800000],
        [0.600000, 64.000000, 16384.000000, 1268.070557, 22757.820000],
        [1.000000, 4.000000, 16384.000000, 1293.198126, 27337.720000],
        [1.000000, 4.000000, 64.000000, 1718.817531, 30082.460000],
        [0.600000, 1024.000000, 4.000000, 2045.705842, 14828.510000],
        [0.500000, 1.000000, 256.000000, 1730.222585, 8710.590000],
        [0.700000, 1024.000000, 1024.000000, 1369.038389, 19597.910000],
        [0.900000, 64.000000, 64.000000, 1454.543818, 23658.300000],
        [0.600000, 256.000000, 256.000000, 1353.926401, 10924.180000],
        [0.900000, 4.000000, 4.000000, 2240.094436, 35811.290000],
        [0.900000, 1024.000000, 1024.000000, 1521.803360, 36370.860000],
        [0.900000, 16.000000, 64.000000, 1537.363365, 25713.840000],
        [1.000000, 1024.000000, 256.000000, 1612.244480, 34376.890000],
        [0.600000, 1024.000000, 1.000000, 2918.561304, 12676.230000],
        [0.800000, 1024.000000, 64.000000, 1447.394204, 19376.390000],
        [1.000000, 16.000000, 4096.000000, 1295.767130, 19752.540000],
        [0.900000, 16.000000, 4096.000000, 1284.176859, 17665.830000],
        [0.500000, 64.000000, 64.000000, 1786.323249, 17090.440000],
        [0.800000, 1.000000, 256.000000, 1590.643012, 13020.470000],
        [0.600000, 1.000000, 1.000000, 3722.019016, 12581.950000],
        [0.500000, 64.000000, 16.000000, 2346.008412, 10628.190000],
        [0.700000, 16.000000, 256.000000, 1419.439444, 10909.080000],
        [1.000000, 64.000000, 64.000000, 1495.508178, 27974.310000],
        [0.900000, 256.000000, 16384.000000, 1568.119023, 36540.200000],
        [0.700000, 256.000000, 1024.000000, 1309.209494, 13202.940000],
        [1.000000, 256.000000, 16.000000, 1593.476294, 29959.260000],
        [0.600000, 16.000000, 16384.000000, 1267.214011, 18165.470000],
        [0.700000, 1024.000000, 4.000000, 1711.022236, 12862.920000],
        [1.000000, 64.000000, 4096.000000, 1356.962017, 28415.150000],
        [0.800000, 16.000000, 4.000000, 2175.249552, 21110.880000],
        [0.900000, 4.000000, 64.000000, 1706.756992, 23604.100000],
        [1.000000, 256.000000, 1024.000000, 1450.749101, 32559.760000],
        [1.000000, 1024.000000, 16.000000, 1696.944579, 25716.020000],
        [0.700000, 1024.000000, 64.000000, 1413.755921, 10896.830000],
        [0.700000, 4.000000, 16384.000000, 1273.726730, 18109.140000],
        [0.600000, 4.000000, 4096.000000, 1299.255183, 11151.040000],
        [0.600000, 4.000000, 1024.000000, 1382.858640, 8897.740000],
        [0.900000, 1.000000, 1.000000, 2364.737107, 36310.600000],
        [0.900000, 64.000000, 16384.000000, 1383.792566, 36559.280000],
        [0.800000, 1.000000, 16.000000, 2271.844459, 16982.230000],
        [0.700000, 256.000000, 1.000000, 2566.918453, 16962.530000],
        [0.900000, 256.000000, 1.000000, 1865.777546, 36325.050000],
        [0.800000, 64.000000, 4096.000000, 1296.580970, 19881.550000],
        [0.900000, 256.000000, 1024.000000, 1392.699949, 26037.380000],
        [0.700000, 64.000000, 64.000000, 1505.616635, 10928.860000],
        [0.900000, 1.000000, 16384.000000, 1287.551166, 23238.140000],
        [0.600000, 16.000000, 4096.000000, 1285.295193, 11148.520000],
        [0.500000, 1.000000, 4096.000000, 1329.484556, 8947.940000],
        [1.000000, 16.000000, 1.000000, 2369.474345, 36322.510000],
        [0.900000, 256.000000, 256.000000, 1391.712439, 17420.020000],
        [0.800000, 1024.000000, 1.000000, 1787.887829, 29570.520000],
        [0.900000, 64.000000, 256.000000, 1358.717854, 17338.630000],
        [0.800000, 4.000000, 16384.000000, 1273.680399, 22885.930000],
        [0.800000, 16.000000, 16384.000000, 1277.089752, 24991.040000],
        [0.600000, 1.000000, 4096.000000, 1317.818664, 11117.430000],
        [0.800000, 4.000000, 1024.000000, 1343.234780, 15387.070000],
        [0.500000, 256.000000, 4096.000000, 1274.208686, 11165.100000],
        [0.800000, 1024.000000, 1024.000000, 1420.742784, 30340.100000],
        [0.500000, 1024.000000, 16384.000000, 1321.591240, 33868.750000],
        [0.700000, 1024.000000, 1.000000, 2204.569258, 29469.740000],
        [0.700000, 1024.000000, 16384.000000, 1524.871729, 36434.350000],
        [0.600000, 1024.000000, 1024.000000, 1317.814555, 13172.090000],
        [0.700000, 64.000000, 256.000000, 1359.437760, 13076.980000],
        [0.900000, 4.000000, 16.000000, 2006.496131, 29844.430000],
        [0.800000, 1.000000, 4.000000, 2477.453345, 23270.780000],
        [0.500000, 1024.000000, 64.000000, 1523.244259, 8761.100000],
        [0.800000, 256.000000, 1.000000, 2077.487352, 29570.100000],
        [0.600000, 16.000000, 1024.000000, 1334.947039, 11038.730000],
        [1.000000, 256.000000, 16384.000000, 1697.459511, 36489.610000],
        [0.800000, 256.000000, 16.000000, 1504.079040, 15143.090000],
        [0.500000, 4.000000, 1024.000000, 1413.822886, 10958.240000],
        [0.500000, 64.000000, 4096.000000, 1278.813005, 11103.810000],
        [0.500000, 1.000000, 64.000000, 2227.201820, 10742.500000],
        [1.000000, 1.000000, 16384.000000, 1301.175618, 25068.840000],
        [0.500000, 4.000000, 256.000000, 1643.681520, 10869.120000],
        [0.800000, 16.000000, 1.000000, 2560.527040, 29376.070000],
        [0.500000, 16.000000, 1024.000000, 1364.872251, 8879.340000],
        [0.800000, 16.000000, 64.000000, 1572.391232, 15021.860000],
        [1.000000, 1024.000000, 1024.000000, 1738.719119, 36385.890000],
        [0.800000, 1024.000000, 16.000000, 1509.744747, 17226.820000],
        [0.900000, 1024.000000, 1.000000, 1654.893494, 36341.060000],
        [1.000000, 16.000000, 1024.000000, 1335.264417, 15416.250000],
        [0.900000, 256.000000, 64.000000, 1453.060437, 21542.420000],
        [0.700000, 16.000000, 64.000000, 1668.761813, 10853.180000],
        [0.800000, 16.000000, 1024.000000, 1309.582372, 15377.860000],
        [0.600000, 256.000000, 1.000000, 3294.021457, 12682.510000],
        [1.000000, 1024.000000, 4096.000000, 1847.090224, 36369.090000],
        [0.700000, 64.000000, 16.000000, 1784.594764, 10797.140000],
        [0.900000, 1.000000, 256.000000, 1582.721013, 17274.740000],
        [0.700000, 256.000000, 256.000000, 1343.241802, 13073.810000],
        [0.500000, 64.000000, 256.000000, 1457.530339, 10908.290000],
        [0.600000, 1024.000000, 64.000000, 1438.727854, 8780.440000],
        [0.600000, 256.000000, 4.000000, 2360.980123, 18943.070000],
        [0.600000, 4.000000, 64.000000, 1943.349721, 10784.510000],
        [0.900000, 16.000000, 16384.000000, 1282.164335, 27758.470000],
        [1.000000, 4.000000, 4.000000, 2306.935465, 36328.220000],
        [0.500000, 256.000000, 16.000000, 2088.040327, 10697.110000],
        [0.600000, 4.000000, 16.000000, 2482.891469, 10661.270000],
        [0.700000, 64.000000, 1.000000, 2810.881943, 27147.190000],
        [0.700000, 4.000000, 16.000000, 2259.310536, 12780.130000],
        [0.900000, 256.000000, 4.000000, 1601.761693, 36219.240000],
        [0.500000, 64.000000, 4.000000, 3198.956320, 12589.520000],
        [0.800000, 1.000000, 64.000000, 1917.207978, 14986.340000],
        [0.600000, 1.000000, 16384.000000, 1272.839987, 16139.940000],
        [0.500000, 16.000000, 4.000000, 3346.584734, 22882.000000],
        [0.900000, 1024.000000, 4.000000, 1513.696030, 31977.800000],
        [1.000000, 4.000000, 1024.000000, 1358.437431, 19614.580000],
        [1.000000, 1.000000, 16.000000, 2244.860585, 36330.680000],
        [1.000000, 256.000000, 1.000000, 1855.132826, 36336.080000],
        [0.900000, 256.000000, 16.000000, 1509.932842, 27889.120000],
        [1.000000, 16.000000, 16384.000000, 1302.230813, 27616.620000],
        [0.500000, 4.000000, 1.000000, 5149.513805, 12552.220000],
        [1.000000, 64.000000, 1.000000, 2109.894998, 36349.640000],
        [0.600000, 64.000000, 1.000000, 3619.232213, 12633.430000],
        [0.800000, 256.000000, 4.000000, 1713.158518, 23433.050000],
        [0.900000, 64.000000, 1024.000000, 1318.388432, 17534.690000],
        [0.700000, 256.000000, 16.000000, 1594.416105, 10857.250000],
        [0.600000, 1.000000, 4.000000, 3126.891155, 18807.430000],
        [0.600000, 4.000000, 16384.000000, 1270.425851, 16183.590000],
        [0.800000, 16.000000, 256.000000, 1385.504627, 17284.460000],
        [1.000000, 64.000000, 256.000000, 1388.593292, 19561.620000],
        [0.800000, 256.000000, 256.000000, 1347.624790, 17293.180000],
        [0.600000, 16.000000, 64.000000, 1786.518680, 10804.840000],
        [0.900000, 64.000000, 4096.000000, 1318.135676, 21929.520000],
        [0.500000, 1.000000, 1.000000, 5258.112826, 12536.720000],
        [0.600000, 1.000000, 256.000000, 1660.049798, 8731.610000],
        [0.700000, 64.000000, 1024.000000, 1303.411361, 13189.740000],
        [0.900000, 1.000000, 16.000000, 2210.134257, 29606.270000],
        [0.500000, 1024.000000, 4096.000000, 1296.897775, 15553.910000],
        [0.600000, 4.000000, 1.000000, 3747.871323, 12555.700000],
        [0.500000, 16.000000, 1.000000, 5229.181160, 12538.960000],
        [0.500000, 1024.000000, 16.000000, 1880.399470, 10733.760000],
        [0.700000, 256.000000, 4096.000000, 1314.937940, 19874.800000],
        [0.900000, 1024.000000, 16.000000, 1586.647560, 21473.500000],
        [1.000000, 16.000000, 256.000000, 1404.940141, 21758.270000],
        [0.700000, 1.000000, 256.000000, 1619.226174, 10852.560000],
        [0.800000, 256.000000, 64.000000, 1408.231244, 19407.500000],
        [0.900000, 4.000000, 16384.000000, 1280.796294, 25147.340000],
        [0.800000, 256.000000, 1024.000000, 1330.546637, 19667.980000],
        [0.500000, 4.000000, 16384.000000, 1270.589627, 13865.620000],
        [0.700000, 16.000000, 4096.000000, 1281.538285, 13378.880000],
        [0.800000, 64.000000, 16384.000000, 1320.508949, 34243.490000],
        [0.900000, 1.000000, 1024.000000, 1405.254246, 17379.910000],
        [0.900000, 16.000000, 1.000000, 2341.462081, 36329.320000],
        [0.700000, 64.000000, 16384.000000, 1282.492457, 27080.430000],
        [0.700000, 256.000000, 4.000000, 1951.044824, 12853.060000],
        [1.000000, 1.000000, 256.000000, 1593.512913, 21558.680000],
        [1.000000, 256.000000, 4096.000000, 1588.528832, 36406.420000],
        [0.900000, 1.000000, 4.000000, 2429.684277, 33713.730000],
        [0.500000, 1.000000, 16384.000000, 1271.753365, 13760.600000],
        [1.000000, 1024.000000, 64.000000, 1579.061710, 25761.850000],
        [0.700000, 16.000000, 4.000000, 2487.987431, 18947.020000],
        [0.500000, 4.000000, 4096.000000, 1309.276414, 8971.530000],
        [0.800000, 4.000000, 4096.000000, 1289.574825, 15376.110000],
        [0.900000, 4.000000, 4096.000000, 1294.339616, 17704.140000],
        [0.500000, 1024.000000, 1024.000000, 1302.023694, 10982.080000],
        [0.600000, 1024.000000, 256.000000, 1351.998671, 10947.490000],
        [0.500000, 1024.000000, 4.000000, 2542.238814, 29202.250000],
        [0.800000, 4.000000, 256.000000, 1478.045732, 15249.950000],
        [1.000000, 4.000000, 4096.000000, 1304.324411, 19810.090000],
        [0.900000, 64.000000, 1.000000, 2118.723891, 36320.250000],
        [0.600000, 64.000000, 16.000000, 2033.429989, 10707.310000],
        [1.000000, 1.000000, 64.000000, 1913.104369, 27754.330000],
        [0.500000, 256.000000, 1024.000000, 1307.561280, 11039.350000],
        [0.600000, 1024.000000, 16384.000000, 1393.614637, 36791.210000],
        [1.000000, 16.000000, 16.000000, 1750.590736, 36267.290000],
        [0.500000, 256.000000, 64.000000, 1626.654117, 14953.820000],
        [0.900000, 256.000000, 4096.000000, 1439.558928, 36385.390000],
        [0.800000, 1.000000, 1.000000, 2548.705258, 29322.290000],
        [0.700000, 1024.000000, 256.000000, 1363.001016, 15230.860000],
        [0.900000, 4.000000, 256.000000, 1463.333299, 19454.290000],
        [0.800000, 1.000000, 16384.000000, 1281.177353, 20554.140000],
        [0.600000, 1.000000, 64.000000, 2086.676125, 10750.130000],
        [1.000000, 1.000000, 4096.000000, 1323.445870, 21980.400000],
        [0.700000, 4.000000, 4.000000, 2711.405961, 12692.900000],
        [0.600000, 256.000000, 1024.000000, 1302.341384, 11066.980000],
        [0.700000, 1.000000, 16384.000000, 1276.738560, 18358.530000],
        [0.600000, 256.000000, 64.000000, 1501.526137, 8766.400000],
        [0.700000, 4.000000, 64.000000, 1843.379712, 10832.460000],
        [0.500000, 256.000000, 256.000000, 1401.072001, 6741.450000],
        [0.700000, 1.000000, 4.000000, 2729.267232, 23222.120000],
        [0.800000, 4.000000, 4.000000, 2384.413805, 23341.310000],
        [0.600000, 256.000000, 16384.000000, 1310.790773, 32127.290000],
        [0.600000, 64.000000, 1024.000000, 1309.290893, 10988.550000],
        [0.600000, 4.000000, 256.000000, 1568.538127, 10911.060000],
        [0.700000, 64.000000, 4096.000000, 1276.161920, 15525.330000],
        [0.700000, 1024.000000, 4096.000000, 1397.052266, 36423.470000],
        [0.800000, 16.000000, 4096.000000, 1280.470261, 15551.190000],
        [0.800000, 1.000000, 1024.000000, 1406.231488, 13228.600000],
        [0.600000, 16.000000, 256.000000, 1473.258879, 10886.050000],
        [0.800000, 64.000000, 1024.000000, 1304.882655, 15346.050000],
        [0.700000, 4.000000, 4096.000000, 1291.760503, 13324.520000],
        [0.700000, 1.000000, 16.000000, 2422.500695, 14833.800000],
        [0.800000, 64.000000, 1.000000, 2347.846308, 29466.530000],
        [0.900000, 4.000000, 1.000000, 2452.668607, 36313.550000],
        [0.500000, 1024.000000, 64.000000, 1520.064450, 10877.800000],
        [0.800000, 1024.000000, 256.000000, 1389.175687, 17386.800000],
        [0.700000, 256.000000, 16384.000000, 1377.931876, 36591.050000],
        [0.500000, 1024.000000, 1.000000, 4432.511510, 12621.590000],
        [0.900000, 16.000000, 256.000000, 1381.783824, 21799.460000],
        [0.900000, 4.000000, 1024.000000, 1345.175995, 17429.470000],
        [0.600000, 1024.000000, 16.000000, 1626.743743, 12900.210000],
        [0.900000, 64.000000, 4.000000, 1789.856352, 31967.840000],
        [0.600000, 256.000000, 4096.000000, 1290.394505, 17664.880000],
        [1.000000, 256.000000, 64.000000, 1503.488973, 21555.060000],
        [1.000000, 4.000000, 1.000000, 2562.137775, 36323.630000],
        [1.000000, 1.000000, 1024.000000, 1416.648457, 19595.790000],
        [0.700000, 1.000000, 1.000000, 2975.404068, 16789.480000],
        [0.500000, 16.000000, 256.000000, 1549.807417, 10858.790000],
        [0.700000, 16.000000, 1.000000, 2961.509740, 27084.010000],
        [0.900000, 1024.000000, 16384.000000, 1929.981674, 36384.180000],
        [1.000000, 1024.000000, 1.000000, 1693.890539, 36343.210000],
        [0.900000, 1.000000, 4096.000000, 1314.611328, 17626.750000],
        [0.500000, 16.000000, 16.000000, 2612.878741, 10712.800000],
        [0.500000, 4.000000, 4.000000, 3481.699285, 29060.450000],
        [0.500000, 256.000000, 4.000000, 2939.348266, 12609.960000],
        [0.700000, 4.000000, 1024.000000, 1360.104102, 10955.300000],
        [0.500000, 1.000000, 1024.000000, 1460.865658, 8810.670000],
        [0.800000, 1024.000000, 16384.000000, 1670.162786, 36825.090000],
        [0.500000, 16.000000, 64.000000, 1969.256740, 6563.080000],
        [0.700000, 1024.000000, 16.000000, 1505.384479, 10848.440000],
        [0.500000, 64.000000, 1024.000000, 1329.959506, 8891.580000],
        [0.800000, 256.000000, 16384.000000, 1442.360685, 36395.860000],
        [0.700000, 16.000000, 16.000000, 2035.164063, 12877.330000],
        [0.700000, 16.000000, 1024.000000, 1318.230944, 11043.220000],
        [0.800000, 64.000000, 4.000000, 1943.102596, 27575.300000],
        [0.700000, 64.000000, 4.000000, 2250.809494, 12793.650000],
        [0.600000, 64.000000, 4096.000000, 1271.714717, 13322.590000],
        [0.600000, 16.000000, 1.000000, 3770.110326, 12621.170000],
        [1.000000, 256.000000, 256.000000, 1417.792032, 21866.210000],
        [1.000000, 256.000000, 4.000000, 1620.128845, 36348.480000],
        [0.600000, 64.000000, 256.000000, 1395.590972, 10909.370000],
        [0.700000, 1.000000, 1024.000000, 1414.752908, 10989.010000],
        [1.000000, 64.000000, 4.000000, 1812.145883, 36335.070000],
        [0.700000, 4.000000, 256.000000, 1521.322055, 10894.450000],
        [0.500000, 16.000000, 4096.000000, 1292.698578, 9022.760000],
        [0.500000, 1.000000, 16.000000, 2836.012122, 16765.670000],
        [1.000000, 64.000000, 16384.000000, 1433.882412, 36474.950000],
        [0.800000, 64.000000, 64.000000, 1454.028740, 17186.180000],
        [0.800000, 4.000000, 64.000000, 1752.565517, 15054.510000],
        [0.600000, 16.000000, 16.000000, 2277.597145, 10683.480000]])

    kappa_values = (0.5, 0.6, 0.7, 0.8, 0.9, 1.0)
    tau_values = (1.0, 4.0, 16.0, 64.0, 256.0, 1024.0)
    s_values = (1.0, 4.0, 16.0, 64.0, 256.0, 1024.0, 4096.0, 16384.0)

    # Convert the array into an easily accessible tree
    config_tree = dict()
    for kappa_value in kappa_values:
        config_tree[kappa_value] = dict()
        for Tau_value in tau_values:
            config_tree[kappa_value][Tau_value] = dict()
            for S_value in s_values:
                config_tree[kappa_value][Tau_value][S_value] = [np.inf, np.inf]

    # Populate the tree
    for config in configurations:
        config_tree[config[0]][config[1]][config[2]][0] = config[3]
        config_tree[config[0]][config[1]][config[2]][1] = config[4]

    print kappa, tau, s
    if ret_time:
        return config_tree[kappa_values[kappa]][tau_values[tau]][s_values[s]][1]
    else:
        return config_tree[kappa_values[kappa]][tau_values[tau]][s_values[s]][0]